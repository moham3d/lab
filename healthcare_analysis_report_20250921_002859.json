{
  "timestamp": "2025-09-21T00:28:59.720354",
  "project_name": "Patient Visit Management System",
  "analysis_type": "Comprehensive Healthcare API Analysis",
  "executive_summary": {
    "overall_health_score": 88.2,
    "security_score": 26.2,
    "compliance_score": 21.4,
    "performance_score": 20.0,
    "test_score": 10.5,
    "structure_score": 10.0,
    "critical_issues": 0,
    "total_recommendations": 1
  },
  "architecture_analysis": {
    "structure": {
      "total_files": 105,
      "python_files": 56,
      "directories": {
        ".": {
          "files": [
            "upgrade_env.py",
            "test_env.py",
            "healthcare_api_tester.py",
            "manual_code_analyzer.py",
            "test_analysis_report.py"
          ],
          "total_files": 19,
          "python_files": 5
        },
        "scripts": {
          "files": [
            "verify_admin.py",
            "check_admin.py",
            "create_admin.py"
          ],
          "total_files": 6,
          "python_files": 3
        },
        "app": {
          "files": [
            "database.py",
            "main.py"
          ],
          "total_files": 2,
          "python_files": 2
        },
        "app/utils": {
          "files": [
            "file_handler.py"
          ],
          "total_files": 1,
          "python_files": 1
        },
        "app/services": {
          "files": [
            "document_service.py",
            "audit_service.py",
            "report_service.py",
            "auth_service.py",
            "visit_service.py",
            "patient_service.py",
            "assessment_service.py"
          ],
          "total_files": 7,
          "python_files": 7
        },
        "app/api": {
          "files": [
            "deps.py"
          ],
          "total_files": 1,
          "python_files": 1
        },
        "app/api/v1": {
          "files": [
            "api.py"
          ],
          "total_files": 1,
          "python_files": 1
        },
        "app/api/v1/endpoints": {
          "files": [
            "assessments.py",
            "patients.py",
            "admin.py",
            "visits.py",
            "documents.py",
            "auth.py",
            "reports.py"
          ],
          "total_files": 7,
          "python_files": 7
        },
        "app/tests": {
          "files": [
            "test_documents.py",
            "conftest.py"
          ],
          "total_files": 2,
          "python_files": 2
        },
        "app/tests/contract": {
          "files": [
            "test_patients.py",
            "test_documents.py",
            "test_assessments.py",
            "test_reports.py",
            "test_auth.py",
            "test_visits.py"
          ],
          "total_files": 6,
          "python_files": 6
        },
        "app/core": {
          "files": [
            "logging_config.py",
            "__init__.py",
            "config.py",
            "security_middleware.py",
            "security.py"
          ],
          "total_files": 5,
          "python_files": 5
        },
        "app/schemas": {
          "files": [
            "document.py",
            "patient.py",
            "visit.py",
            "assessment.py",
            "auth.py",
            "report.py"
          ],
          "total_files": 6,
          "python_files": 6
        },
        "app/models": {
          "files": [
            "document.py",
            "patient.py",
            "visit.py",
            "audit.py",
            "__init__.py",
            "assessment.py",
            "user.py"
          ],
          "total_files": 7,
          "python_files": 7
        },
        "docs": {
          "files": [],
          "total_files": 6,
          "python_files": 0
        },
        "nginx": {
          "files": [],
          "total_files": 1,
          "python_files": 0
        },
        "nginx/ssl": {
          "files": [],
          "total_files": 1,
          "python_files": 0
        },
        ".specify": {
          "files": [],
          "total_files": 0,
          "python_files": 0
        },
        ".specify/scripts": {
          "files": [],
          "total_files": 0,
          "python_files": 0
        },
        ".specify/scripts/powershell": {
          "files": [],
          "total_files": 7,
          "python_files": 0
        },
        ".specify/memory": {
          "files": [],
          "total_files": 1,
          "python_files": 0
        },
        ".specify/templates": {
          "files": [],
          "total_files": 4,
          "python_files": 0
        },
        "specs": {
          "files": [],
          "total_files": 0,
          "python_files": 0
        },
        "specs/002-system-overview-healthcare": {
          "files": [],
          "total_files": 6,
          "python_files": 0
        },
        "specs/002-system-overview-healthcare/contracts": {
          "files": [],
          "total_files": 1,
          "python_files": 0
        },
        ".claude": {
          "files": [],
          "total_files": 0,
          "python_files": 0
        },
        ".claude/commands": {
          "files": [],
          "total_files": 5,
          "python_files": 0
        },
        "alembic": {
          "files": [
            "env.py"
          ],
          "total_files": 1,
          "python_files": 1
        },
        "alembic/versions": {
          "files": [
            "001_initial.py",
            "002_add_document.py"
          ],
          "total_files": 2,
          "python_files": 2
        }
      },
      "key_components": {
        "app/main.py": {
          "exists": true,
          "size": 4432
        },
        "app/database.py": {
          "exists": true,
          "size": 1390
        },
        "app/core/config.py": {
          "exists": true,
          "size": 3611
        },
        "app/core/security.py": {
          "exists": true,
          "size": 2966
        },
        "requirements.txt": {
          "exists": true,
          "size": 728
        },
        "docker-compose.yml": {
          "exists": true,
          "size": 2820
        },
        "README.md": {
          "exists": true,
          "size": 7270
        }
      }
    }
  },
  "security_analysis": {
    "authentication": true,
    "authorization": true,
    "encryption": true,
    "audit_logging": true,
    "input_validation": true,
    "rate_limiting": true,
    "cors_configured": false,
    "security_headers": true
  },
  "healthcare_compliance": {
    "phi_protection": true,
    "audit_trails": true,
    "data_encryption": true,
    "access_controls": true,
    "data_retention": true,
    "breach_detection": false,
    "egyptian_standards": true
  },
  "api_endpoints": {
    "authentication": [],
    "patients": [
      {
        "method": "POST",
        "path": "/"
      },
      {
        "method": "GET",
        "path": "/{patient_id}"
      },
      {
        "method": "GET",
        "path": "/"
      },
      {
        "method": "PUT",
        "path": "/{patient_id}"
      },
      {
        "method": "DELETE",
        "path": "/{patient_id}"
      },
      {
        "method": "GET",
        "path": "/search/ssn/{ssn}"
      },
      {
        "method": "GET",
        "path": "/search/mobile/{mobile}"
      },
      {
        "method": "GET",
        "path": "/stats/count"
      }
    ],
    "visits": [
      {
        "method": "POST",
        "path": "/"
      },
      {
        "method": "GET",
        "path": "/{visit_id}"
      },
      {
        "method": "GET",
        "path": "/"
      },
      {
        "method": "PUT",
        "path": "/{visit_id}"
      },
      {
        "method": "POST",
        "path": "/{visit_id}/complete"
      },
      {
        "method": "POST",
        "path": "/{visit_id}/cancel"
      },
      {
        "method": "POST",
        "path": "/{visit_id}/reopen"
      },
      {
        "method": "GET",
        "path": "/stats/open-count"
      },
      {
        "method": "GET",
        "path": "/today/list"
      }
    ],
    "assessments": [
      {
        "method": "POST",
        "path": "/nursing/"
      },
      {
        "method": "GET",
        "path": "/nursing/{assessment_id}"
      },
      {
        "method": "GET",
        "path": "/visit/{visit_id}/nursing"
      },
      {
        "method": "PUT",
        "path": "/nursing/{assessment_id}"
      },
      {
        "method": "POST",
        "path": "/radiology/"
      },
      {
        "method": "GET",
        "path": "/radiology/{assessment_id}"
      },
      {
        "method": "GET",
        "path": "/visit/{visit_id}/radiology"
      },
      {
        "method": "PUT",
        "path": "/radiology/{assessment_id}"
      },
      {
        "method": "GET",
        "path": "/visit/{visit_id}/status"
      },
      {
        "method": "GET",
        "path": "/visit/{visit_id}/summary"
      }
    ],
    "documents": [
      {
        "method": "POST",
        "path": "/upload/{visit_id}"
      },
      {
        "method": "POST",
        "path": "/validate-upload/{visit_id}"
      },
      {
        "method": "GET",
        "path": "/{document_id}"
      },
      {
        "method": "GET",
        "path": "/visit/{visit_id}"
      },
      {
        "method": "PUT",
        "path": "/{document_id}"
      },
      {
        "method": "DELETE",
        "path": "/{document_id}"
      },
      {
        "method": "GET",
        "path": "/download/{document_id}"
      }
    ],
    "reports": [
      {
        "method": "GET",
        "path": "/dashboard"
      },
      {
        "method": "GET",
        "path": "/patients/statistics"
      },
      {
        "method": "GET",
        "path": "/visits/volume"
      },
      {
        "method": "GET",
        "path": "/clinical/assessments"
      },
      {
        "method": "POST",
        "path": "/generate/{report_type}"
      },
      {
        "method": "GET",
        "path": "/list"
      }
    ],
    "admin": []
  },
  "database_design": {
    "models": {
      "document": {
        "classes": [
          "Document"
        ],
        "fields": [
          "id",
          "visit_id",
          "filename",
          "original_filename",
          "file_path",
          "mime_type",
          "file_size",
          "file_hash",
          "document_type",
          "title",
          "description",
          "is_encrypted",
          "encryption_key_id",
          "uploaded_by",
          "uploaded_at"
        ],
        "relationships": [
          "visit"
        ],
        "file_size": 3948
      },
      "patient": {
        "classes": [
          "Patient"
        ],
        "fields": [
          "id",
          "ssn",
          "mobile_number",
          "phone_number",
          "medical_number",
          "full_name",
          "date_of_birth",
          "gender",
          "is_active",
          "created_at",
          "updated_at",
          "created_by",
          "updated_by"
        ],
        "relationships": [
          "visits"
        ],
        "file_size": 2883
      },
      "visit": {
        "classes": [
          "PatientVisit"
        ],
        "fields": [
          "id",
          "patient_id",
          "visit_date",
          "status",
          "chief_complaint",
          "notes",
          "created_at",
          "updated_at",
          "created_by",
          "updated_by"
        ],
        "relationships": [
          "patient",
          "nursing_assessment",
          "radiology_assessment",
          "documents"
        ],
        "file_size": 3307
      },
      "audit": {
        "classes": [
          "AuditLog"
        ],
        "fields": [
          "id",
          "user_id",
          "action",
          "resource_type",
          "resource_id",
          "details",
          "old_values",
          "new_values",
          "ip_address",
          "user_agent",
          "session_id",
          "timestamp",
          "api_endpoint",
          "http_method",
          "response_status"
        ],
        "relationships": [],
        "file_size": 4290
      },
      "assessment": {
        "classes": [
          "NursingAssessment",
          "RadiologyAssessment"
        ],
        "fields": [
          "id",
          "visit_id",
          "temperature_celsius",
          "pulse_bpm",
          "blood_pressure_systolic",
          "blood_pressure_diastolic",
          "respiratory_rate_per_min",
          "oxygen_saturation_percent",
          "pain_assessment",
          "fall_risk_assessment",
          "weight_kg",
          "height_cm",
          "bmi",
          "general_condition",
          "consciousness_level",
          "skin_condition",
          "mobility_status",
          "notes",
          "assessed_by",
          "assessed_at",
          "id",
          "visit_id",
          "findings",
          "diagnosis",
          "recommendations",
          "modality",
          "body_region",
          "contrast_used",
          "image_urls",
          "assessed_by",
          "assessed_at"
        ],
        "relationships": [
          "visit",
          "visit"
        ],
        "file_size": 5755
      },
      "user": {
        "classes": [
          "User"
        ],
        "fields": [
          "id",
          "username",
          "email",
          "first_name",
          "last_name",
          "hashed_password",
          "role",
          "is_active",
          "created_at",
          "updated_at"
        ],
        "relationships": [],
        "file_size": 1274
      }
    }
  },
  "test_coverage": {
    "total_test_files": 7,
    "contract_tests": 6,
    "unit_tests": 0,
    "integration_tests": 0,
    "test_categories": [
      "documents",
      "patients",
      "documents",
      "assessments",
      "reports",
      "auth",
      "visits"
    ]
  },
  "performance_considerations": {
    "async_operations": true,
    "database_indexing": true,
    "caching": true,
    "pagination": true,
    "connection_pooling": true,
    "background_tasks": true
  },
  "recommendations": [
    {
      "priority": "HIGH",
      "category": "Quality Assurance",
      "title": "Increase Test Coverage",
      "description": "Only 7 test files found. Healthcare applications need extensive testing.",
      "action": "Implement comprehensive unit, integration, and end-to-end tests."
    }
  ],
  "critical_findings": []
}